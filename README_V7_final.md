# üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ GitLab —Å GitLab Runner –∏ SonarQube –≤ Docker –¥–ª—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (V7 - –§–ò–ù–ê–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø)

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Ä–µ—à–µ–Ω–∏—è)
3. [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
4. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
5. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
6. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
8. [–°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-–ø—Ä–æ–µ–∫—Ç–∞](#—Å–æ–∑–¥–∞–Ω–∏–µ-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–µ–±-–ø—Ä–æ–µ–∫—Ç–∞)
9. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CI/CD —Å SonarQube](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-cicd-—Å-sonarqube)
10. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
11. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ GitLab, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –¥–ª—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (CSS, HTML, PHP, JavaScript), –≤–º–µ—Å—Ç–µ —Å GitLab Runner –∏ SonarQube –≤ —Å—Ä–µ–¥–µ Docker. –ú—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω CI/CD, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–¥, –≤–∫–ª—é—á–∞—è –∞–Ω–∞–ª–∏–∑ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ LESS, —Å –ø–æ–º–æ—â—å—é SonarQube –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å –µ–≥–æ.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ V7:**
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è 4 —è–¥–µ—Ä / 16GB RAM
- ‚úÖ –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ WSL2 –∏ Linux
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–ø–æ–ª–∞–¥–æ–∫
- ‚úÖ –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –°–µ—Ç–µ–≤–∞—è —Å—Ö–µ–º–∞

```
+-----------------------------------------------------------------------+
| Docker Host (WSL2 Ubuntu / –§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä)                         |
|                                                                       |
|  +----------------+      +------------------+      +---------------+  |
|  | GitLab         |      | GitLab Runner    |      | SonarQube     |  |
|  | 192.168.56.10  |      | 192.168.56.30    |      | 192.168.56.20 |  |
|  | gitlab.localdomain|   |                  |      | sonarqube.localdomain|
|  | Ports: 80,443,2224 |  |                  |      | Port: 9000    |  |
|  +----------------+      +------------------+      +---------------+  |
|                                                                       |
|                  Docker Network: 192.168.56.0/24                     |
+-----------------------------------------------------------------------+
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
~/gitlab-setup/                      # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞ Docker Compose
‚îú‚îÄ‚îÄ docker-compose.yml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ setup-hosts.sh                  # –°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ hosts
‚îú‚îÄ‚îÄ check-network.sh                # –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ç–∏
‚îú‚îÄ‚îÄ wait-gitlab-working.sh          # –°–∫—Ä–∏–ø—Ç –æ–∂–∏–¥–∞–Ω–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ GitLab
‚îú‚îÄ‚îÄ reset-project.sh                # –°–∫—Ä–∏–ø—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ full_reset_docker.sh            # –°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ Docker

/var/opt/gitlab/                    # –í–ù–£–¢–†–ò –ö–û–ù–¢–ï–ô–ù–ï–†–ê GitLab
‚îú‚îÄ‚îÄ git-data/
‚îÇ   ‚îî‚îÄ‚îÄ repositories/              # üëà –ó–î–ï–°–¨ –•–†–ê–ù–Ø–¢–°–Ø –ü–†–û–ï–ö–¢–´ GITLAB
‚îÇ       ‚îú‚îÄ‚îÄ @hashed/               # –•—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ab/ct/.../         # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—ç—à-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ       ‚îî‚îÄ‚îÄ user/                  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ           ‚îú‚îÄ‚îÄ project1.git/      # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π project1
‚îÇ           ‚îî‚îÄ‚îÄ group/project2.git/# –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π project2 –≤ –≥—Ä—É–ø–ø–µ
‚îú‚îÄ‚îÄ postgresql/                    # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö GitLab
‚îî‚îÄ‚îÄ uploads/                       # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–¥–ª—è 4 —è–¥–µ—Ä / 16GB):**
- **GitLab**: 3GB RAM, 1.5 CPU ‚¨áÔ∏è
- **SonarQube**: 2GB RAM, 1.0 CPU ‚¨áÔ∏è
- **Runner**: 512MB RAM, 0.5 CPU ‚¨áÔ∏è
- **–í—Å–µ–≥–æ**: 5.5GB RAM, 3.0 CPU ‚¨áÔ∏è

**WSL2 –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- **–ü–∞–º—è—Ç—å**: 12GB (–≤–º–µ—Å—Ç–æ 10GB)
- **–Ø–¥—Ä–∞**: 3 (–≤–º–µ—Å—Ç–æ 4)
- **Swap**: 4GB (–≤–º–µ—Å—Ç–æ 2GB)

–≠—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–µ—Å–ø–µ—á–∞—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ 4-—è–¥–µ—Ä–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏! üöÄ

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–î–ª—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º:**
- Docker 20.10+ –∏ Docker Compose 2.0+
- 10 –ì–ë –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 12 –ì–ë)
- –ë–æ–ª–µ–µ 20 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏

**–î–ª—è WSL2:**
- Windows 10/11 —Å WSL2
- Ubuntu 20.04+ –∏–∑ Microsoft Store
- Docker Desktop —Å WSL2 integration

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏
free -h

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞
df -h

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
docker --version
docker-compose --version

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–¥–ª—è Linux)
grep -E --color '(vmx|svm)' /proc/cpuinfo
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```bash
#!/bin/bash
# quick-deploy-4core.sh

echo "üöÄ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –î–õ–Ø 4-–Ø–î–ï–†–ù–û–ô –°–ò–°–¢–ï–ú–´"

set -e

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤..."
CORES=$(nproc)
MEMORY_GB=$(grep MemTotal /proc/meminfo | awk '{print int($2/1024/1024)}')

echo "   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ —è–¥–µ—Ä: $CORES"
echo "   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ –ø–∞–º—è—Ç–∏: ${MEMORY_GB}GB"

if [ $MEMORY_GB -lt 10 ]; then
    echo "‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –ú–∞–ª–æ –ø–∞–º—è—Ç–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 10GB –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã."
fi

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p ~/gitlab-setup
cd ~/gitlab-setup

echo "üì• –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."

# –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ docker-compose.yml
cat > docker-compose.yml << 'EOF'
version: '3.8'

services:
  gitlab:
    image: gitlab/gitlab-ce:latest
    container_name: gitlab
    hostname: gitlab.localdomain
    restart: unless-stopped
    environment:
      GITLAB_OMNIBUS_CONFIG: |
        external_url 'http://gitlab.localdomain'
        gitlab_rails['gitlab_shell_ssh_port'] = 2224
        # üîß –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –î–õ–Ø 4-–Ø–î–ï–†–ù–û–ô –°–ò–°–¢–ï–ú–´
        prometheus_monitoring['enable'] = false
        puma['worker_processes'] = 2
        puma['min_threads'] = 1
        puma['max_threads'] = 2
        sidekiq['max_concurrency'] = 3
        nginx['worker_processes'] = 1
        nginx['worker_connections'] = 512
        postgresql['shared_buffers'] = '256MB'
        redis['maxmemory'] = '128mb'
        redis['maxmemory_policy'] = 'allkeys-lru'
    ports:
      - "80:80"
      - "443:443"
      - "2224:22"
    volumes:
      - gitlab_config:/etc/gitlab
      - gitlab_logs:/var/log/gitlab
      - gitlab_data:/var/opt/gitlab
    networks:
      gitlab-network:
        ipv4_address: 192.168.56.10
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:80"]
      interval: 30s
      timeout: 10s
      retries: 20
      start_period: 600s
    mem_limit: 3g
    mem_reservation: 2g
    cpus: 1.5

  gitlab-runner:
    image: gitlab/gitlab-runner:latest
    container_name: gitlab-runner
    restart: unless-stopped
    depends_on:
      - gitlab
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - gitlab-runner-config:/etc/gitlab-runner
    networks:
      gitlab-network:
        ipv4_address: 192.168.56.30
    extra_hosts:
      - "gitlab.localdomain:192.168.56.10"
      - "sonarqube.localdomain:192.168.56.20"
    mem_limit: 512m
    cpus: 0.5

  sonarqube:
    image: sonarqube:9.9.1-community
    container_name: sonarqube
    hostname: sonarqube.localdomain
    restart: unless-stopped
    environment:
      SONAR_ES_BOOTSTRAP_CHECKS_DISABLE: "true"
      # üîß –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –î–õ–Ø 4-–Ø–î–ï–†–ù–û–ô –°–ò–°–¢–ï–ú–´
      SONAR_WEB_JAVAOPTS: "-Xmx512m -Xms256m -XX:MaxMetaspaceSize=128m"
      SONAR_CE_JAVAOPTS: "-Xmx512m -Xms256m -XX:MaxMetaspaceSize=128m"
      SONAR_SEARCH_JAVAOPTS: "-Xmx512m -Xms256m -XX:MaxMetaspaceSize=128m"
    ports:
      - "9000:9000"
    volumes:
      - sonarqube_data:/opt/sonarqube/data
      - sonarqube_extensions:/opt/sonarqube/extensions
      - sonarqube_logs:/opt/sonarqube/logs
    networks:
      gitlab-network:
        ipv4_address: 192.168.56.20
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/api/system/status"]
      interval: 30s
      timeout: 10s
      retries: 10
      start_period: 180s
    mem_limit: 2g
    mem_reservation: 1g
    cpus: 1.0

volumes:
  gitlab_config:
  gitlab_logs:
  gitlab_data:
  gitlab-runner-config:
  sonarqube_data:
  sonarqube_extensions:
  sonarqube_logs:

networks:
  gitlab-network:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.56.0/24
          gateway: 192.168.56.1
EOF

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hosts —Ñ–∞–π–ª–∞
echo "üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hosts —Ñ–∞–π–ª–∞..."
sudo bash -c 'cat >> /etc/hosts << EOL
192.168.56.10    gitlab.localdomain
192.168.56.20    sonarqube.localdomain
EOL'

# –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
echo "üê≥ –ó–∞–ø—É—Å–∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
docker-compose up -d

echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤..."
sleep 30

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤..."
docker-compose ps

echo ""
echo "üéâ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!"
echo ""
echo "üìä –í–´–î–ï–õ–ï–ù–ù–´–ï –†–ï–°–£–†–°–´:"
echo "   ‚Ä¢ GitLab: 3GB RAM, 1.5 CPU"
echo "   ‚Ä¢ SonarQube: 2GB RAM, 1.0 CPU" 
echo "   ‚Ä¢ Runner: 512MB RAM, 0.5 CPU"
echo "   ‚Ä¢ –í—Å–µ–≥–æ: ~5.5GB RAM, 3.0 CPU"
echo ""
echo "üí° –î–ê–õ–¨–ù–ï–ô–®–ò–ï –î–ï–ô–°–¢–í–ò–Ø:"
echo "   1. –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ WSL2: ./optimize-wsl2-4core.sh"
echo "   2. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∑–∞–ø—É—Å–∫: ./wait-gitlab-working.sh"
echo "   3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º—É: ./system-check.sh"
```

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WSL2 –¥–ª—è 4 —è–¥–µ—Ä / 16GB RAM

```bash
#!/bin/bash
# optimize-wsl2-4core.sh

echo "‚ö° –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø WSL2 –î–õ–Ø –°–ò–°–¢–ï–ú–´ –° 4 –Ø–î–†–ê–ú–ò –ò 16GB RAM"

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—É—é –ø–∞–º—è—Ç—å –∏ —è–¥—Ä–∞
TOTAL_MEMORY_GB=15.8
TOTAL_CORES=4
TOTAL_THREADS=4

echo "üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã:"
echo "   ‚Ä¢ –Ø–¥—Ä–∞: $TOTAL_CORES"
echo "   ‚Ä¢ –ü–æ—Ç–æ–∫–∏: $TOTAL_THREADS" 
echo "   ‚Ä¢ –ü–∞–º—è—Ç—å: ${TOTAL_MEMORY_GB}GB"
echo ""

# –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
WSL_MEMORY=$(( ${TOTAL_MEMORY_GB%.*} - 4 ))  # –û—Å—Ç–∞–≤–ª—è–µ–º 4GB –¥–ª—è Windows
WSL_PROCESSORS=$(( TOTAL_CORES - 1 ))         # –û—Å—Ç–∞–≤–ª—è–µ–º 1 —è–¥—Ä–æ –¥–ª—è Windows
WSL_SWAP=$(( WSL_MEMORY / 2 ))                # Swap = 50% –æ—Ç –ø–∞–º—è—Ç–∏

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
if [ $WSL_MEMORY -gt 12 ]; then
    WSL_MEMORY=12
fi
if [ $WSL_PROCESSORS -gt 3 ]; then
    WSL_PROCESSORS=3
fi
if [ $WSL_SWAP -gt 4 ]; then
    WSL_SWAP=4
fi

echo "üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WSL2:"
echo "   ‚Ä¢ –ü–∞–º—è—Ç—å: ${WSL_MEMORY}GB"
echo "   ‚Ä¢ –Ø–¥—Ä–∞: ${WSL_PROCESSORS}"
echo "   ‚Ä¢ Swap: ${WSL_SWAP}GB"
echo ""

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ WSL2
cat > /mnt/c/Users/$USER/.wslconfig << EOF
[wsl2]
# –†–µ—Å—É—Ä—Å—ã –¥–ª—è WSL2 (–æ—Å—Ç–∞–≤–ª—è–µ–º —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è Windows)
memory=${WSL_MEMORY}GB
processors=${WSL_PROCESSORS}
swap=${WSL_SWAP}GB
swapfile=%USERPROFILE%\\\\wsl-swap.vhdx

# –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
localhostForwarding=true
dnsTunneling=true
firewall=true
autoProxy=true

# –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
pageReporting=true
kernelCommandLine=intel_pstate=disable

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
vmIdleTimeout=3600000

# –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
[experimental]
autoMemoryReclaim=dropcache
sparseVhd=true
dnsTunneling=true
hostAddressLoopback=true
EOF

echo "‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è WSL2 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞:"
cat /mnt/c/Users/$USER/.wslconfig

echo ""
echo "üîÅ –î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:"
echo "   wsl --shutdown"
echo "   wsl"
echo ""
echo "üí° –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ WSL –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:"
echo "   cat /proc/meminfo | grep -i memtotal"
echo "   nproc"
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
mkdir -p ~/gitlab-setup
cd ~/gitlab-setup
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hosts —Ñ–∞–π–ª–∞

```bash
#!/bin/bash
# setup-hosts.sh

echo "=== –ù–ê–°–¢–†–û–ô–ö–ê HOSTS –§–ê–ô–õ–ê ==="

HOSTS_FILE="/etc/hosts"
BACKUP_FILE="${HOSTS_FILE}.backup.$(date +%Y%m%d%H%M%S)"

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
sudo cp $HOSTS_FILE $BACKUP_FILE
echo "üì¶ –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è: $BACKUP_FILE"

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
sudo sed -i '/192.168.56/d' $HOSTS_FILE

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
sudo tee -a $HOSTS_FILE << EOL

# GitLab Infrastructure
192.168.56.10    gitlab.localdomain
192.168.56.20    sonarqube.localdomain
EOL

echo "‚úÖ Hosts —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–∏—Å–µ–π:"
grep "192.168.56" $HOSTS_FILE
```

---

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—Å–∫–∞
docker-compose logs -f gitlab &

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –£–ª—É—á—à–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–∂–∏–¥–∞–Ω–∏—è GitLab

```bash
#!/bin/bash
# wait-for-gitlab.sh

echo "üéØ –£–õ–£–ß–®–ï–ù–ù–´–ô –ú–û–ù–ò–¢–û–†–ò–ù–ì –ó–ê–ü–£–°–ö–ê GITLAB"

check_gitlab_health() {
    local container_status=$(docker inspect gitlab --format='{{.State.Health.Status}}' 2>/dev/null)
    local http_status=$(curl -s -o /dev/null -w "%{http_code}" http://gitlab.localdomain 2>/dev/null)
    local logs_status=$(docker-compose logs gitlab 2>/dev/null | tail -5)
    
    echo "üìä –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: $container_status"
    echo "üåê HTTP —Å—Ç–∞—Ç—É—Å: $http_status"
    
    if [ "$http_status" = "200" ]; then
        return 0
    else
        return 1
    fi
}

get_root_password() {
    local password=$(docker-compose exec gitlab grep 'Password:' /etc/gitlab/initial_root_password 2>/dev/null | cut -d: -f2- | sed 's/^ *//;s/ *$//')
    
    if [ -n "$password" ]; then
        echo "üîê ROOT PASSWORD: $password"
        return 0
    else
        echo "‚ö†Ô∏è –ü–∞—Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –º–µ—Å—Ç–µ"
        return 1
    fi
}

echo "‚è≥ –ù–∞—á–∞–ª–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–ø—É—Å–∫–∞ GitLab..."
echo "üìù –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 10-15 –º–∏–Ω—É—Ç..."

for i in {1..60}; do
    echo ""
    echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ #$i ($(date))"
    
    if check_gitlab_health; then
        echo ""
        echo "üéâ GITLAB –£–°–ü–ï–®–ù–û –ó–ê–ü–£–©–ï–ù!"
        echo ""
        
        # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
        sleep 30
        
        echo "üîí –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è root..."
        if get_root_password; then
            echo ""
            echo "üöÄ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï!"
            echo "üåê GitLab: http://gitlab.localdomain"
            echo "üë§ –õ–æ–≥–∏–Ω: root"
            echo "üîë –ü–∞—Ä–æ–ª—å: (—Å–º. –≤—ã—à–µ)"
        else
            echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"
            echo "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é: docker-compose exec gitlab cat /etc/gitlab/initial_root_password"
        fi
        
        exit 0
    fi
    
    echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ... (10 —Å–µ–∫—É–Ω–¥)"
    sleep 10
done

echo ""
echo "‚ùå –ü–†–ï–í–´–®–ï–ù–û –í–†–ï–ú–Ø –û–ñ–ò–î–ê–ù–ò–Ø"
echo "üí° GitLab –≤—Å–µ –µ—â–µ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é:"
echo "   docker-compose logs gitlab"
echo "   curl http://gitlab.localdomain"
exit 1
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitLab Runner

```bash
#!/bin/bash
# setup-runner.sh

echo "üîß –ù–ê–°–¢–†–û–ô–ö–ê GITLAB RUNNER"

# –û–∂–∏–¥–∞–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å GitLab
echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ GitLab..."
until curl -s http://gitlab.localdomain > /dev/null; do
    sleep 10
done

# –ü–æ–ª—É—á–µ–Ω–∏–µ registration token
echo "üìù –ü–æ–ª—É—á–µ–Ω–∏–µ registration token..."
REGISTRATION_TOKEN=$(docker-compose exec gitlab gitlab-rails runner -e production "puts Gitlab::CurrentSettings.current_application_settings.runners_registration_token")

if [ -z "$REGISTRATION_TOKEN" ]; then
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å registration token"
    echo "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ GitLab"
    exit 1
fi

echo "‚úÖ Registration token –ø–æ–ª—É—á–µ–Ω"

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Runner
echo "üöÄ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è GitLab Runner..."
docker-compose exec gitlab-runner gitlab-runner register \
  --non-interactive \
  --url "http://gitlab.localdomain/" \
  --registration-token "$REGISTRATION_TOKEN" \
  --executor "docker" \
  --docker-image "alpine:latest" \
  --description "web-development-runner" \
  --tag-list "docker,linux,web,less" \
  --run-untagged="true" \
  --locked="false" \
  --docker-privileged="true" \
  --docker-volumes "/var/run/docker.sock:/var/run/docker.sock" \
  --docker-volumes "/cache" \
  --docker-volumes "/builds:/builds"

echo "‚úÖ GitLab Runner —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Runner..."
docker-compose exec gitlab-runner gitlab-runner list
```

---

## –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-–ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
mkdir -p ~/web-dev-project
cd ~/web-dev-project

# –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
mkdir -p css js src/less dist/css dist/js tests
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

**üìç –§–∞–π–ª: `~/web-dev-project/index.html`**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Web Project</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>Simple Web Project</h1>
        <p>Testing GitLab CI/CD with SonarQube</p>
    </header>
    
    <main>
        <section>
            <h2>Features</h2>
            <ul>
                <li>HTML5 Structure</li>
                <li>LESS Stylesheets</li>
                <li>JavaScript Functionality</li>
                <li>CI/CD Pipeline</li>
            </ul>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2024 Web Project</p>
    </footer>
    
    <script src="js/app.js"></script>
</body>
</html>
```

**üìç –§–∞–π–ª: `~/web-dev-project/src/less/style.less`**
```less
// Variables
@primary-color: #3498db;
@secondary-color: #2ecc71;
@text-color: #2c3e50;
@background-color: #ecf0f1;

// Mixins
.border-radius(@radius: 5px) {
  border-radius: @radius;
}

.box-shadow(@x: 0, @y: 2px, @blur: 5px, @color: rgba(0,0,0,0.1)) {
  box-shadow: @x @y @blur @color;
}

// Base styles
body {
  font-family: Arial, sans-serif;
  line-height: 1.6;
  color: @text-color;
  background-color: @background-color;
  margin: 0;
  padding: 20px;
}

header {
  background: @primary-color;
  color: white;
  padding: 2rem;
  text-align: center;
  .border-radius(10px);
  .box-shadow(0, 4px, 10px, rgba(0,0,0,0.2));

  h1 {
    margin: 0;
    
    &:hover {
      color: lighten(@primary-color, 20%);
      transition: color 0.3s ease;
    }
  }
  
  p {
    margin: 0.5rem 0 0 0;
    opacity: 0.9;
  }
}

main {
  max-width: 800px;
  margin: 2rem auto;
  padding: 0 1rem;
}

section {
  background: white;
  padding: 1.5rem;
  .border-radius(8px);
  .box-shadow();
  
  h2 {
    color: @primary-color;
    margin-bottom: 1rem;
  }
  
  ul {
    list-style: none;
    padding: 0;
    
    li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #eee;
      
      &:last-child {
        border-bottom: none;
      }
      
      &:hover {
        color: @secondary-color;
        transform: translateX(5px);
        transition: all 0.3s ease;
      }
    }
  }
}

footer {
  text-align: center;
  margin-top: 3rem;
  padding: 1rem;
  color: #7f8c8d;
}
```

**üìç –§–∞–π–ª: `~/web-dev-project/js/app.js`**
```javascript
// Simple JavaScript functionality
document.addEventListener('DOMContentLoaded', function() {
    console.log('Web application loaded');
    
    // Add interactivity to list items
    const listItems = document.querySelectorAll('li');
    listItems.forEach(item => {
        item.addEventListener('click', function() {
            this.style.backgroundColor = '#f8f9fa';
            setTimeout(() => {
                this.style.backgroundColor = '';
            }, 300);
        });
    });
    
    // Add current year to footer
    const yearElement = document.querySelector('footer p');
    if (yearElement) {
        const currentYear = new Date().getFullYear();
        yearElement.textContent = `¬© ${currentYear} Web Project`;
    }
});
```

**üìç –§–∞–π–ª: `~/web-dev-project/package.json`**
```json
{
  "name": "web-dev-project",
  "version": "1.0.0",
  "description": "Simple web project for GitLab CI/CD demonstration",
  "scripts": {
    "build:less": "lessc src/less/style.less css/style.css",
    "build": "npm run build:less"
  },
  "devDependencies": {
    "less": "^4.1.3"
  }
}
```

### –®–∞–≥ 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
#!/bin/bash
# init-project.sh

echo "üéØ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø GIT –†–ï–ü–û–ó–ò–¢–û–†–ò–Ø"

cd ~/web-dev-project

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git
git init

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
git config --local user.name "root"
git config --local user.email "root@gitlab.localdomain"

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
git add .

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞
git commit -m "Initial commit: Simple web project with HTML, LESS, and JavaScript

- Basic HTML structure
- LESS styles with variables and mixins
- Simple JavaScript functionality
- Package.json for build scripts
- Ready for CI/CD integration"

echo "‚úÖ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω"
echo "üìä –°—Ç–∞—Ç—É—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:"
git status
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CI/CD —Å SonarQube

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SonarQube

```bash
#!/bin/bash
# setup-sonarqube.sh

echo "üîß –ù–ê–°–¢–†–û–ô–ö–ê SONARQUBE –î–õ–Ø –í–ï–ë-–†–ê–ó–†–ê–ë–û–¢–ö–ò"

echo "üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ SonarQube:"
echo ""
echo "1. üåê –û—Ç–∫—Ä–æ–π—Ç–µ: http://sonarqube.localdomain:9000"
echo "2. üîê –í–æ–π–¥–∏—Ç–µ: admin/admin"
echo "3. üîí –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –Ω–∞ 'Netology2024!'"
echo "4. üì¶ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–≥–∏–Ω—ã:"
echo "   ‚Ä¢ SonarCSS (–¥–ª—è CSS/LESS –∞–Ω–∞–ª–∏–∑–∞)"
echo "   ‚Ä¢ SonarHTML (–¥–ª—è HTML –∞–Ω–∞–ª–∏–∑–∞)" 
echo "   ‚Ä¢ SonarPHP (–¥–ª—è PHP –∞–Ω–∞–ª–∏–∑–∞)"
echo "   ‚Ä¢ SonarJS (—É–∂–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)"
echo "5. üé´ –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω:"
echo "   ‚Ä¢ My Account ‚Üí Security ‚Üí Generate Token"
echo "   ‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ: gitlab-web-token"
echo "   ‚Ä¢ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞"
echo ""
echo "‚ö†Ô∏è  –ó–ê–ü–ò–®–ò–¢–ï –¢–û–ö–ï–ù: ________________"

read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SonarQube..."
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ CI/CD

**üìç –§–∞–π–ª: `~/web-dev-project/.gitlab-ci.yml`**
```yaml
# üìç –†–ê–°–ü–û–õ–û–ñ–ï–ù–ò–ï: –ö–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitLab –ø—Ä–æ–µ–∫—Ç–∞
# GitLab –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–∏ –ø—É—à–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

stages:
  - test
  - quality
  - build

variables:
  SONAR_USER_HOME: "${CI_PROJECT_DIR}/.sonar"
  GIT_DEPTH: "0"
  NODE_VERSION: "18"

cache:
  key: "${CI_COMMIT_REF_SLUG}"
  paths:
    - node_modules/
    - .sonar/cache
    - css/

# –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ SonarQube
sonarqube-analysis:
  stage: quality
  image: 
    name: sonarsource/sonar-scanner-cli:latest
    entrypoint: [""]
  variables:
    SONAR_SCANNER_OPTS: "-Xmx512m"
  before_script:
    - echo "192.168.56.20 sonarqube.localdomain" >> /etc/hosts
  script:
    - echo "üîç –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ SonarQube..."
    - sonar-scanner
      -Dsonar.projectKey=${CI_PROJECT_NAME}
      -Dsonar.projectName=${CI_PROJECT_NAME}
      -Dsonar.projectVersion=${CI_COMMIT_SHORT_SHA}
      -Dsonar.host.url=${SONAR_HOST_URL}
      -Dsonar.token=${SONAR_TOKEN}
      -Dsonar.sources=.
      -Dsonar.sourceEncoding=UTF-8
      -Dsonar.exclusions=node_modules/**,css/**,**/*.min.js
      -Dsonar.tests=./tests
  artifacts:
    reports:
      codequality: gl-sonar-report.json
    paths:
      - .sonar/cache
    expire_in: 1 week
  allow_failure: false
  only:
    - main
    - merge_requests
  tags:
    - web
    - docker

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è LESS
compile-less:
  stage: build
  image: node:${NODE_VERSION}-alpine
  before_script:
    - apk add --no-cache less
  script:
    - echo "üé® –ö–æ–º–ø–∏–ª—è—Ü–∏—è LESS –≤ CSS..."
    - npx lessc src/less/style.less css/style.css --clean-css
    - echo "‚úÖ LESS —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ"
    - ls -la css/
  artifacts:
    name: "compiled-css"
    paths:
      - css/
    expire_in: 1 week
  only:
    - main
    - merge_requests
  tags:
    - web
    - docker

# –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–µ
notify-success:
  stage: build
  image: alpine:latest
  script:
    - echo "üéâ –ü–∞–π–ø–ª–∞–π–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!"
    - echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"
    - echo "   - –ö–æ–º–º–∏—Ç: ${CI_COMMIT_SHORT_SHA}"
    - echo "   - –í–µ—Ç–∫–∞: ${CI_COMMIT_REF_NAME}"
  only:
    - main
  when: on_success
  tags:
    - web
    - docker
```

**üìç –§–∞–π–ª: `~/web-dev-project/sonar-project.properties`**
```properties
# üìç –†–ê–°–ü–û–õ–û–ñ–ï–ù–ò–ï: –ö–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitLab –ø—Ä–æ–µ–∫—Ç–∞
# SonarScanner –∏—â–µ—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

sonar.projectKey=web-dev-project
sonar.projectName=Web Development Project
sonar.projectVersion=1.0

# –ü—É—Ç–∏ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É
sonar.sources=.,src,js
sonar.tests=./tests

# –ò—Å–∫–ª—é—á–µ–Ω–∏—è
sonar.exclusions=node_modules/**,css/**,**/*.min.js,**/*.min.css

# –ö–æ–¥–∏—Ä–æ–≤–∫–∞
sonar.sourceEncoding=UTF-8

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
sonar.html.file.suffixes=.html,.htm
sonar.css.file.suffixes=.css,.less
sonar.js.file.suffixes=.js

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
sonar.qualitygate.wait=true
sonar.qualitygate.timeout=300

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è LESS –∞–Ω–∞–ª–∏–∑–∞
sonar.less.parser.less=src/less/style.less
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ GitLab

```bash
#!/bin/bash
# setup-gitlab-project.sh

echo "üöÄ –ù–ê–°–¢–†–û–ô–ö–ê –ü–†–û–ï–ö–¢–ê –í GITLAB"

cd ~/web-dev-project

echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞..."
./check-project-structure.sh

echo "üåê –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
git remote add origin http://gitlab.localdomain/root/web-dev-project.git

echo "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤ GitLab..."
git push -u origin main

echo ""
echo "üéâ –ü–†–û–ï–ö–¢ –£–°–ü–ï–®–ù–û –ó–ê–ì–†–£–ñ–ï–ù –í GITLAB!"
echo ""
echo "üìù –î–ê–õ–¨–ù–ï–ô–®–ò–ï –î–ï–ô–°–¢–í–ò–Ø:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ: http://gitlab.localdomain/root/web-dev-project"
echo "2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: Settings ‚Üí CI/CD ‚Üí Variables"
echo "3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:"
echo "   - SONAR_HOST_URL = http://sonarqube.localdomain:9000"
echo "   - SONAR_TOKEN = [–≤–∞—à_—Ç–æ–∫–µ–Ω_–∏–∑_sonarqube]"
echo "4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–π–ø–ª–∞–π–Ω: CI/CD ‚Üí Pipelines"
echo "5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–Ω–∞–ª–∏–∑: http://sonarqube.localdomain:9000"
```

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ gitlab-setup
cd ~/gitlab-setup

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs gitlab
docker-compose logs sonarqube --follow
docker-compose logs gitlab-runner

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞/–∑–∞–ø—É—Å–∫
docker-compose stop
docker-compose start
docker-compose restart

# –ü–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
docker-compose down

# –ü–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö (‚ö†Ô∏è –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker-compose down -v
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats

# –†–∞–∑–º–µ—Ä volumes
docker system df

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
docker system prune -f
```

### –°–∫—Ä–∏–ø—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

```bash
#!/bin/bash
# reset-project.sh

echo "=== üóëÔ∏è –ë–ï–ó–û–ü–ê–°–ù–ê–Ø –û–ß–ò–°–¢–ö–ê –ü–†–û–ï–ö–¢–ê GITLAB-SONARQUBE ==="

cd ~/gitlab-setup

if [ -f "docker-compose.yml" ]; then
    echo "–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ —É–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞..."
    docker-compose down -v
    
    echo "–£–¥–∞–ª—è–µ–º volumes –ø—Ä–æ–µ–∫—Ç–∞..."
    docker volume rm gitlab-setup_gitlab_config \
                     gitlab-setup_gitlab_logs \
                     gitlab-setup_gitlab_data \
                     gitlab-setup_gitlab-runner-config \
                     gitlab-setup_sonarqube_data \
                     gitlab-setup_sonarqube_extensions \
                     gitlab-setup_sonarqube_logs 2>/dev/null || true
    
    echo "–£–¥–∞–ª—è–µ–º —Å–µ—Ç—å –ø—Ä–æ–µ–∫—Ç–∞..."
    docker network rm gitlab-network 2>/dev/null || true
    
    echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
else
    echo "‚ùå docker-compose.yml –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞"
fi
```

### –°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ Docker

```bash
#!/bin/bash
# full_reset_docker.sh

# –í–´–ü–û–õ–ù–Ø–ô–¢–ï –≠–¢–ò –ö–û–ú–ê–ù–î–´ –¢–û–õ–¨–ö–û –ï–°–õ–ò –í–´ –ü–û–ù–ò–ú–ê–ï–¢–ï –ü–û–°–õ–ï–î–°–¢–í–ò–Ø!
# –≠–¢–û –£–î–ê–õ–ò–¢ –í–°–ï –í–ê–®–ò DOCKER –ö–û–ù–¢–ï–ô–ù–ï–†–´, VOLUMES –ò –°–ï–¢–ò!

echo "=== üî• –û–ü–ê–°–ù–û: –ü–û–õ–ù–ê–Ø –û–ß–ò–°–¢–ö–ê DOCKER ==="
echo "–≠–¢–û –£–î–ê–õ–ò–¢:"
echo "‚úÖ –í—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã"
echo "‚úÖ –í—Å–µ Docker volumes (–≤–∫–ª—é—á–∞—è –¥–∞–Ω–Ω—ã–µ GitLab, –ë–î –∏ —Ç.–¥.)"
echo "‚úÖ –í—Å–µ Docker —Å–µ—Ç–∏"
echo "‚úÖ –í—Å–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã"
echo ""
echo "–í–°–ï –î–ê–ù–ù–´–ï –ë–£–î–£–¢ –ë–ï–ó–í–û–ó–í–†–ê–¢–ù–û –£–¢–ï–†–Ø–ù–´!"
echo "========================================"

read -p "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/NO): " confirmation

if [ "$confirmation" != "yes" ]; then
    echo "–û—á–∏—Å—Ç–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞."
    exit 1
fi

# –í—ã–ø–æ–ª–Ω—è–µ–º –≤ –ª—é–±–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ - —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Docker
echo "–ù–∞—á–∏–Ω–∞–µ–º –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É Docker..."

# 1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
echo "1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
docker stop $(docker ps -aq) 2>/dev/null || echo "–ù–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏"

# 2. –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
echo "2. –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
docker rm $(docker ps -aq) 2>/dev/null || echo "–ù–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è"

# 3. –£–¥–∞–ª—è–µ–º –≤—Å–µ volumes
echo "3. –£–¥–∞–ª—è–µ–º –≤—Å–µ volumes..."
docker volume rm $(docker volume ls -q) 2>/dev/null || echo "–ù–µ—Ç volumes –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è"

# 4. –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–µ—Ç–∏ (–∫—Ä–æ–º–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö)
echo "4. –£–¥–∞–ª—è–µ–º –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–µ—Ç–∏..."
docker network rm $(docker network ls -q --filter type=custom) 2>/dev/null || echo "–ù–µ—Ç —Å–µ—Ç–µ–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è"

# 5. –û—á–∏—â–∞–µ–º –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã
echo "5. –£–¥–∞–ª—è–µ–º –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã..."
docker image prune -a -f

# 6. –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—á–∏—Å—Ç–∫–∞
echo "6. –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã Docker..."
docker system prune -a -f --volumes

echo ""
echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! Docker –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω."
echo "‚ö†Ô∏è  –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã!"
```

### –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã

```bash
#!/bin/bash
# system-check.sh

echo "=== üîç –ö–û–ú–ü–õ–ï–ö–°–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –°–ò–°–¢–ï–ú–´ ==="
echo "–í–µ—Ä—Å–∏—è: V7 - $(date)"
echo ""

cd ~/gitlab-setup

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker —Å–µ—Ä–≤–∏—Å–æ–≤
echo "1. üê≥ –ü–†–û–í–ï–†–ö–ê DOCKER –°–ï–†–í–ò–°–û–í"
echo "----------------------------------------"
docker-compose ps
echo ""

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
echo "2. üìä –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –†–ï–°–£–†–°–û–í"
echo "----------------------------------------"
echo "üíæ –ü–∞–º—è—Ç—å:"
docker stats --no-stream --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.MemPerc}}" | head -10
echo ""

echo "üíΩ –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:"
docker system df
echo ""

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
echo "3. üöÄ –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –°–ï–†–í–ò–°–û–í"
echo "----------------------------------------"

check_service() {
    local name=$1
    local url=$2
    
    echo -n "üîç $name: "
    if curl -s -f "$url" > /dev/null; then
        echo "‚úÖ –î–û–°–¢–£–ü–ï–ù"
        return 0
    else
        echo "‚ùå –ù–ï–î–û–°–¢–£–ü–ï–ù"
        return 1
    fi
}

check_service "GitLab" "http://gitlab.localdomain"
check_service "SonarQube" "http://sonarqube.localdomain:9000"

echo ""

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ GitLab Runner
echo "4. ‚öôÔ∏è –ü–†–û–í–ï–†–ö–ê GITLAB RUNNER"
echo "----------------------------------------"
if docker ps | grep -q gitlab-runner; then
    echo "‚úÖ GitLab Runner –∑–∞–ø—É—â–µ–Ω"
    docker-compose exec gitlab-runner gitlab-runner list 2>/dev/null || echo "‚ùå Runner –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"
else
    echo "‚ùå GitLab Runner –Ω–µ –∑–∞–ø—É—â–µ–Ω"
fi
echo ""

# 5. –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
echo "5. üéØ –ò–¢–û–ì–û–í–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê"
echo "----------------------------------------"

ALL_OK=true

# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
if ! curl -s http://gitlab.localdomain > /dev/null; then
    echo "‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: GitLab –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
    ALL_OK=false
fi

if ! curl -s http://sonarqube.localdomain:9000 > /dev/null; then
    echo "‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: SonarQube –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
    ALL_OK=false
fi

if ! docker ps | grep -q gitlab-runner; then
    echo "‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: GitLab Runner –Ω–µ –∑–∞–ø—É—â–µ–Ω"
    ALL_OK=false
fi

if [ "$ALL_OK" = true ]; then
    echo ""
    echo "üéâ –í–°–ï –°–ò–°–¢–ï–ú–´ –†–ê–ë–û–¢–ê–Æ–¢ –ù–û–†–ú–ê–õ–¨–ù–û!"
    echo ""
    echo "üåê –î–û–°–¢–£–ü–ù–´–ï –°–ï–†–í–ò–°–´:"
    echo "   ‚Ä¢ GitLab:       http://gitlab.localdomain"
    echo "   ‚Ä¢ SonarQube:    http://sonarqube.localdomain:9000"
    echo "   ‚Ä¢ –ü—Ä–æ–µ–∫—Ç—ã:      http://gitlab.localdomain/root/"
    echo ""
    echo "üöÄ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï!"
else
    echo ""
    echo "‚ö†Ô∏è  –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ü–†–û–ë–õ–ï–ú–´!"
    echo "üí° –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫: ./troubleshoot.sh"
fi

echo ""
echo "=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê ==="
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –°–∫—Ä–∏–ø—Ç —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫

```bash
#!/bin/bash
# troubleshoot.sh

echo "=== üõ†Ô∏è  –£–°–¢–†–ê–ù–ï–ù–ò–ï –ù–ï–ü–û–õ–ê–î–û–ö ==="

cd ~/gitlab-setup

# –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
log() {
    echo "üìù $(date): $1"
}

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ Docker
log "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ Docker..."
docker ps > /dev/null 2>&1
if [ $? -ne 0 ]; then
    echo "‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Docker. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:"
    echo "   - –ó–∞–ø—É—â–µ–Ω –ª–∏ Docker daemon"
    echo "   - –î–æ–±–∞–≤–ª–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –≥—Ä—É–ø–ø—É docker"
    echo "   - –ü—Ä–∞–≤–∞ –Ω–∞ /var/run/docker.sock"
    exit 1
fi
echo "‚úÖ Docker –¥–æ—Å—Ç—É–ø–µ–Ω"

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ docker-compose.yml
log "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ docker-compose..."
if [ ! -f "docker-compose.yml" ]; then
    echo "‚ùå –§–∞–π–ª docker-compose.yml –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi
echo "‚úÖ docker-compose.yml –Ω–∞–π–¥–µ–Ω"

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
log "–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤..."
docker-compose down
sleep 5
docker-compose up -d

# 4. –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞
log "–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤..."
sleep 30

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
log "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤..."
for service in gitlab sonarqube gitlab-runner; do
    if docker-compose ps | grep -q "$service.*Up"; then
        echo "‚úÖ $service –∑–∞–ø—É—â–µ–Ω"
    else
        echo "‚ùå $service –Ω–µ –∑–∞–ø—É—â–µ–Ω"
        echo "–õ–æ–≥–∏ $service:"
        docker-compose logs "$service" --tail=10
    fi
done

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏
log "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏..."
docker network inspect gitlab-network > /dev/null 2>&1
if [ $? -ne 0 ]; then
    echo "‚ùå –°–µ—Ç—å gitlab-network –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –°–æ–∑–¥–∞–µ–º..."
    docker network create --driver=bridge --subnet=192.168.56.0/24 gitlab-network
fi

# 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ hosts —Ñ–∞–π–ª–∞
log "–ü—Ä–æ–≤–µ—Ä–∫–∞ hosts —Ñ–∞–π–ª–∞..."
if ! grep -q "gitlab.localdomain" /etc/hosts; then
    echo "‚ùå –ó–∞–ø–∏—Å–∏ –≤ hosts —Ñ–∞–π–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –î–æ–±–∞–≤–ª—è–µ–º..."
    sudo tee -a /etc/hosts << EOL
192.168.56.10    gitlab.localdomain
192.168.56.20    sonarqube.localdomain
EOL
fi

# 8. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
log "–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞..."
./system-check.sh

echo ""
echo "‚úÖ –£–°–¢–†–ê–ù–ï–ù–ò–ï –ù–ï–ü–û–õ–ê–î–û–ö –ó–ê–í–ï–†–®–ï–ù–û"
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### üéØ –ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ –≤ V7:

1. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤** - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ CPU –¥–ª—è 4-—è–¥–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
2. **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π** - LESS, CSS, HTML, JavaScript
3. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏** - –±—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
4. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∏ –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
5. **–ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞** - –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–µ–±-–ø—Ä–æ–µ–∫—Ç–∞
6. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫
7. **–ß–µ—Ç–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤** - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≥–¥–µ –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
cd ~
mkdir gitlab-setup && cd gitlab-setup

# 2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (–∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é)
# 3. –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
chmod +x *.sh
./quick-deploy-4core.sh

# 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—Å–∫–∞
./wait-for-gitlab.sh

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
./system-check.sh
```

### üìä –ö–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã:

- **GitLab**: http://gitlab.localdomain
- **SonarQube**: http://sonarqube.localdomain:9000  
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø–æ–º–æ—â–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: ./system-check.sh

### üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```bash
cd ~/gitlab-setup
docker-compose start    # –ó–∞–ø—É—Å–∫
docker-compose status   # –°—Ç–∞—Ç—É—Å  
docker-compose stop     # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./troubleshoot.sh       # –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫
```

### üìç –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø –ü–û –†–ê–°–ü–û–õ–û–ñ–ï–ù–ò–Æ –§–ê–ô–õ–û–í:

- **`.gitlab-ci.yml`** - ‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –í –ö–û–†–ù–ï —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitLab –ø—Ä–æ–µ–∫—Ç–∞
- **`sonar-project.properties`** - ‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –í –ö–û–†–ù–ï —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitLab –ø—Ä–æ–µ–∫—Ç–∞
- GitLab –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç `.gitlab-ci.yml` –ø—Ä–∏ –ø—É—à–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- SonarScanner –∏—â–µ—Ç `sonar-project.properties` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

**–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –ø–æ–ª–Ω—ã–º —Ü–∏–∫–ª–æ–º CI/CD!** üéâ

---

*–í–µ—Ä—Å–∏—è V7 - –§–ò–ù–ê–õ–¨–ù–ê–Ø - –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è 4-—è–¥–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∏ –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π*
